"use strict";(self.webpackChunkreact_dev=self.webpackChunkreact_dev||[]).push([[212],{212:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var r=n(43),o=n(579);const s=4,c=-1,a="react2048",l=80,i=10;function u(e){return Array.from({length:e},()=>Array(e).fill(0))}function d(e){const t=[];for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++)0===e[n][r]&&t.push([n,r]);return t}function m(e){const t=d(e);if(0===t.length)return e;const[n,r]=t[Math.floor(Math.random()*t.length)],o=e.map(e=>e.slice());return Math.random()<.3?o[n][r]=c:o[n][r]=Math.random()<.9?2:4,o}function f(){let e=u(s);return e=m(e),e=m(e),e}function h(e,t){const n=e===c;return e===t&&!n||n!==(t===c)}function w(e,t){const n=e===c;if(n&&t===c)return 0;return 2*(n?t:e)}function v(e){const t=e.length,n=u(t);for(let r=0;r<t;r++)for(let o=0;o<t;o++)n[t-1-o][r]=e[r][o];return n}function p(e){const t=e.length,n=u(t);for(let r=0;r<t;r++)for(let o=0;o<t;o++)n[o][t-1-r]=e[r][o];return n}function g(e){return e.map(e=>e.slice().reverse())}function x(e){const t=[];for(let l=0;l<e.length;l++)0!==e[l]&&t.push({v:e[l],fromC:l});const n=[],r=[],o=[];let s=0,c=0;for(let l=0;l<t.length;l++){const e=t[l],a=t[l+1];if(a&&h(e.v,a.v)){const t=w(e.v,a.v);n.push(t),r.push({fromC:e.fromC,toC:c,v:e.v,willMerge:!0}),r.push({fromC:a.fromC,toC:c,v:a.v,willMerge:!0}),o.push(c),s+=t,c++,l++}else n.push(e.v),r.push({fromC:e.fromC,toC:c,v:e.v,willMerge:!1}),c++}for(;n.length<e.length;)n.push(0);const a=r.some(e=>e.fromC!==e.toC);return{merged:n,moves:r,mergedDestCols:o,moved:a,gained:s}}function S(e,t){const n=e.length;let r=e.map(e=>e.slice());"up"===t?r=v(r):"down"===t?r=p(r):"right"===t&&(r=g(r));const o=[],s=[],c=[];let a=0,l=!1;for(let f=0;f<n;f++){const{merged:e,moves:t,mergedDestCols:n,moved:i,gained:u}=x(r[f]);o.push(e),s.push({r:f,moves:t}),n.forEach(e=>c.push({r:f,c:e})),i&&(l=!0),a+=u}let i="up"===t?p(o):"down"===t?v(o):"right"===t?g(o):o;function u(e,r){return"left"===t?{r:e,c:r}:"up"===t?{r:r,c:n-1-e}:"down"===t?{r:n-1-r,c:e}:{r:e,c:n-1-r}}const d=[];s.forEach(e=>{let{r:r,moves:o}=e;o.forEach(e=>{const o=function(e,r){return"left"===t?{r:e,c:r}:"up"===t?{r:r,c:n-1-e}:"down"===t?{r:n-1-r,c:e}:{r:e,c:n-1-r}}(r,e.fromC),s=u(r,e.toC);d.push({fromR:o.r,fromC:o.c,toR:s.r,toC:s.c,v:e.v,willMerge:e.willMerge})})});const m=c.map(e=>{let{r:t,c:n}=e;return u(t,n)});return{next:i,movedAny:l,gainedTotal:a,moves:d,mergedDest:m}}function j(e){return e===c?"cell2048 wild2048":"cell2048 v".concat(e||0)}function C(e,t){return"".concat(e,"-").concat(t)}function b(e,t){return{x:t*(l+i),y:e*(l+i)}}function N(e){if(e<1e4)return null;const t=e-1e4,n=4.5*Math.pow(.85,Math.floor(t/2e3));return Math.max(.7,n)}function y(){const[e,t]=(0,r.useState)(()=>f()),[n,l]=(0,r.useState)(0),[i,u]=(0,r.useState)(!1),[h,w]=(0,r.useState)(null),[v,p]=(0,r.useState)(0),[g,x]=(0,r.useState)(!1),[y,k]=(0,r.useState)(!1),[M,D]=(0,r.useState)(!1),[B,A]=(0,r.useState)([]),[E,T]=(0,r.useState)(!1),[R,L]=(0,r.useState)(()=>new Set),[I,F]=(0,r.useState)(()=>new Set),[G,O]=(0,r.useState)(()=>new Set),[q,H]=(0,r.useState)(()=>{const e=localStorage.getItem(a),t=null==e?0:Number(e);return Number.isFinite(t)?t:0});function U(r){if(i||M)return;const{next:o,movedAny:s,gainedTotal:a,moves:f,mergedDest:h}=S(e,r);s&&(w(e.map(e=>e.slice())),p(n),x(i),k(!0),D(!0),A(f),L(new Set(f.map(e=>C(e.fromR,e.fromC)))),T(!1),requestAnimationFrame(()=>requestAnimationFrame(()=>T(!0))),window.setTimeout(()=>{const e=m(o),n=function(e,t){const n=[];for(let r=0;r<e.length;r++)for(let o=0;o<e[r].length;o++)0===e[r][o]&&0!==t[r][o]&&n.push("".concat(r,"-").concat(o));return n}(o,e);n.length&&(O(new Set(n)),window.setTimeout(()=>O(new Set),140)),t(e),l(e=>e+a),A([]),L(new Set),F(new Set(h.map(e=>C(e.r,e.c)))),function(e){if(d(e).length>0)return!1;const t=e.length;for(let n=0;n<t;n++)for(let r=0;r<t;r++){const o=e[n][r];if(r+1<t){const t=e[n][r+1];if(o===t&&o!==c||o===c!==(t===c))return!1}if(n+1<t){const t=e[n+1][r];if(o===t&&o!==c||o===c!==(t===c))return!1}}return!0}(e)&&u(!0),window.setTimeout(()=>F(new Set),140),D(!1)},65))}return(0,r.useEffect)(()=>{n>q&&(H(n),localStorage.setItem(a,String(n)))},[n,q]),(0,r.useEffect)(()=>{const e=e=>{const t={arrowup:"up",arrowdown:"down",arrowleft:"left",arrowright:"right",w:"up",s:"down",a:"left",d:"right"}[e.key.toLowerCase()];t&&(e.preventDefault(),U(t))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[e,i]),(0,o.jsxs)("div",{className:"container2048",children:[(0,o.jsxs)("div",{className:"instruction2048",children:[(0,o.jsx)("p",{children:"Control Keys:"}),(0,o.jsx)("p",{children:'Buttons below or "AWSD" on your keyboard'}),(0,o.jsx)("p",{children:"Note:"}),(0,o.jsx)("p",{children:"?? can merge with any numbers but itself"})]}),(0,o.jsxs)("div",{className:"header2048",children:[(0,o.jsx)("h2",{className:"title2048",children:"2048"}),(0,o.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(()=>{const e=N(n),t="score2048"+(e?" animateHue2048":""),r=e?{"--hueDur":"".concat(e,"s")}:void 0;return(0,o.jsxs)("span",{className:t,style:r,children:["Score: ",n]})})(),(()=>{const e=N(q),t="best2048"+(e?" animateHue2048":""),n=e?{"--hueDur":"".concat(e,"s")}:void 0;return(0,o.jsxs)("span",{className:t,style:n,children:["Best: ",q]})})(),(0,o.jsx)("button",{className:"btn2048",onClick:function(){const e=f();t(e),l(0),u(!1),A([]),L(new Set),F(new Set),O(new Set),T(!1),D(!1),w(null),p(0),x(!1),k(!1);const n=[];for(let t=0;t<s;t++)for(let r=0;r<s;r++)0!==e[t][r]&&n.push("".concat(t,"-").concat(r));O(new Set(n)),window.setTimeout(()=>O(new Set),140)},children:"New Game"})]})]}),i&&(0,o.jsx)("p",{className:"GameOver2048",children:" Game Over "}),(0,o.jsx)("div",{className:"undoButton2048wapper",children:(0,o.jsx)("button",{className:"btn2048 undoButton2048",onClick:function(){y&&!M&&h&&(t(h),l(v),u(g),A([]),L(new Set),F(new Set),O(new Set),T(!1),k(!1))},disabled:!y,children:"Undo"})}),(0,o.jsxs)("div",{className:"boardWrap2048",children:[(0,o.jsx)("div",{className:"grid2048",style:{"--cols":s},children:e.map((e,t)=>e.map((e,n)=>{const r=C(t,n),s=R.has(r),a=I.has(r),l=G.has(r),i=j(e)+(s?" movingOut2048":"")+(a?" flash2048":"")+(l?" spawn2048":"");return(0,o.jsx)("div",{className:i,children:e===c?"??":e||""},r)}))}),(0,o.jsx)("div",{className:"animLayer2048",children:B.map((e,t)=>{const n=b(e.fromR,e.fromC),r=b(e.toR,e.toC),s=r.x-n.x,a=r.y-n.y,l={left:n.x,top:n.y,transform:"translate3d(".concat(E?s:0,"px, ").concat(E?a:0,"px, 0)"),transitionDuration:"".concat(65,"ms")};return(0,o.jsx)("div",{className:"movingTile2048",children:(0,o.jsx)("div",{className:"movingInner2048 ".concat(j(e.v)),style:l,children:e.v===c?"??":e.v})},t)})})]}),(0,o.jsxs)("div",{className:"controls2048",role:"group","aria-label":"Move controls",children:[(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>U("up"),"aria-label":"Up",children:"\ud83d\udd3c"}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>U("left"),"aria-label":"Left",children:"\u25c0\ufe0f"}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>U("right"),"aria-label":"Right",children:"\u25b6\ufe0f"}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>U("down"),"aria-label":"Down",children:"\ud83d\udd3d"}),(0,o.jsx)("div",{})]})]})}}}]);
//# sourceMappingURL=212.c87a2337.chunk.js.map