{"version":3,"file":"static/js/251.6edb897c.chunk.js","mappings":"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","sources":["../node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","Dice.jsx"],"sourcesContent":["function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}\nexport { _objectSpread2 as default };","import React, { useState, useRef, useEffect } from 'react';\r\n\r\n// constants:\r\nconst DICE_RE = /(?<!\\d)(\\d*)\\s*[dD]\\s*(\\d+)(?!\\d)/g;\r\n\r\n// tool functions:\r\nexport function trimMessage(message) {\r\n  const results = [];\r\n  let m;\r\n\r\n  while ((m = DICE_RE.exec(message)) !== null) {\r\n    const count = m[1] ? parseInt(m[1], 10) : 1;\r\n    const sides = parseInt(m[2], 10);\r\n\r\n    if (count > 0 && sides > 0) {\r\n      results.push({ count, sides, raw: m[0].trim() });\r\n    }\r\n  }\r\n  return results;\r\n}\r\n\r\nexport function rollOnce(sides) {\r\n  return Math.floor(Math.random() * sides) + 1;\r\n}\r\n\r\nexport function rollDice(count, sides) {\r\n  const rolls = Array.from({ length: count }, () => rollOnce(sides));\r\n  const total = rolls.reduce((a, b) => a + b, 0);\r\n  return { rolls, total };\r\n}\r\n\r\nexport function rollFromText(text) {\r\n  const specs = trimMessage(text);\r\n\r\n  return specs.map(spec => ({\r\n    spec,\r\n    ...rollDice(spec.count, spec.sides),\r\n  }));\r\n}\r\n\r\nexport function formatRollResults(results) {\r\n  if (!results || results.length === 0) return null;\r\n\r\n  const lines = results.map((r, i) => {\r\n    const rollsStr = r.rolls.join(', ');\r\n    return `Results : ${r.total}      (${rollsStr})`;\r\n  });\r\n\r\n  // in case if multiple rolls, show grand total\r\n  if (results.length > 1) {\r\n    const grandTotal = results.reduce((s, r) => s + r.total, 0);\r\n    lines.push(`Total Sum: ${grandTotal}`);\r\n  }\r\n\r\n  return lines.join('\\n');\r\n}\r\n\r\n// main component:\r\nexport default function DiceRolling() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [editingId, setEditingId] = useState(null);\r\n  const [editText, setEditText] = useState('');\r\n\r\n  const [histories, setHistories] = useState({});\r\n  const messagesEndRef = useRef(null);\r\n  const inputRef = useRef(null);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  const uuid = () => (crypto?.randomUUID ? crypto.randomUUID() : Date.now().toString());\r\n  const cloneMsgs = (arr) => arr.map(m => ({ ...m }));\r\n  const msgsEqual = (a, b) =>\r\n    a.length === b.length &&\r\n    a.every((m, i) => m.id === b[i].id && m.type === b[i].type && m.content === b[i].content);\r\n\r\n  useEffect(() => {\r\n    setHistories(prev => {\r\n      let changed = false;\r\n      const next = { ...prev };\r\n\r\n      for (const [mid, h] of Object.entries(prev)) {\r\n        const idx = messages.findIndex(m => m.id === mid);\r\n        if (idx !== -1) {\r\n          const newSuffix = cloneMsgs(messages.slice(idx + 1));\r\n          const curVer = h.versions[h.currentIndex];\r\n\r\n          if (!msgsEqual(curVer.suffix, newSuffix)) {\r\n            const newVersions = h.versions.slice();\r\n            newVersions[h.currentIndex] = { ...curVer, suffix: newSuffix };\r\n            next[mid] = { ...h, versions: newVersions };\r\n            changed = true;\r\n          }\r\n        }\r\n      }\r\n      return changed ? next : prev;\r\n    });\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!input.trim()) return;\r\n\r\n    const userMessage = input.trim();\r\n    setInput('');\r\n    setError(null);\r\n\r\n    const newUserMessage = {\r\n      type: 'human',\r\n      content: userMessage,\r\n      id: Date.now().toString(),\r\n    };\r\n\r\n    const snapshot = [...messages, newUserMessage];\r\n    setMessages(snapshot);\r\n    await generateResponse(snapshot);\r\n  };\r\n\r\n  // response generation\r\n  const generateResponse = async (_messageHistory) => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const lastHuman = [..._messageHistory].reverse().find(m => m.type === 'human');\r\n      const text = lastHuman?.content ?? '';\r\n      const results = rollFromText(text);\r\n      const content = results.length ? formatRollResults(results) : ' ';\r\n\r\n      setMessages(prev => [...prev, { type: 'robot', content, id: uuid() }]);\r\n    }\r\n    finally {\r\n      setLoading(false);\r\n      inputRef.current?.focus();\r\n    }\r\n  };\r\n\r\n  const startEdit = (message) => {\r\n    setEditingId(message.id);\r\n    setEditText(message.content);\r\n  };\r\n\r\n  const cancelEdit = () => {\r\n    setEditingId(null);\r\n    setEditText('');\r\n  };\r\n\r\n  const saveEdit = async (messageId) => {\r\n    if (!editText.trim()) return;\r\n\r\n    const messageIndex = messages.findIndex(m => m.id === messageId);\r\n    if (messageIndex === -1) return;\r\n\r\n    const original = messages[messageIndex];\r\n    if (original.type !== 'human') return;\r\n\r\n    const prefix = cloneMsgs(messages.slice(0, messageIndex));\r\n    const originalSuffix = cloneMsgs(messages.slice(messageIndex + 1));\r\n    const newContent = editText.trim();\r\n\r\n    setHistories(prev => {\r\n      const next = { ...prev };\r\n      if (!next[messageId]) {\r\n        next[messageId] = {\r\n          messageId,\r\n          versions: [{\r\n            id: uuid(),\r\n            content: original.content,\r\n            suffix: originalSuffix,\r\n            createdAt: Date.now(),\r\n          }],\r\n          currentIndex: 0,\r\n        };\r\n      }\r\n      return next;\r\n    });\r\n\r\n    setHistories(prev => {\r\n      const h = prev[messageId];\r\n      const newVersion = {\r\n        id: uuid(),\r\n        content: newContent,\r\n        suffix: [],\r\n        createdAt: Date.now(),\r\n      };\r\n      return {\r\n        ...prev,\r\n        [messageId]: {\r\n          messageId,\r\n          versions: [...h.versions, newVersion],\r\n          currentIndex: h.versions.length,\r\n        }\r\n      };\r\n    });\r\n\r\n    const editedHuman = { ...original, content: newContent };\r\n    const newMsgs = [...prefix, editedHuman];\r\n    setMessages(newMsgs);\r\n    setEditingId(null);\r\n    setEditText('');\r\n\r\n    await generateResponse(newMsgs);\r\n  };\r\n\r\n  const navigateVersion = (messageId, dir) => {\r\n    setHistories(prev => {\r\n      const h = prev[messageId];\r\n      if (!h) return prev;\r\n\r\n      const nextIndex = Math.max(0, Math.min(h.versions.length - 1, h.currentIndex + dir));\r\n      if (nextIndex === h.currentIndex) return prev;\r\n\r\n      const selected = h.versions[nextIndex];\r\n\r\n      setMessages(curr => {\r\n        const idx = curr.findIndex(m => m.id === messageId);\r\n        if (idx === -1) return curr;\r\n        const prefix = cloneMsgs(curr.slice(0, idx));\r\n        const human = { ...curr[idx], content: selected.content };\r\n        const suffix = cloneMsgs(selected.suffix);\r\n        return [...prefix, human, ...suffix];\r\n      });\r\n\r\n      return {\r\n        ...prev,\r\n        [messageId]: { ...h, currentIndex: nextIndex }\r\n      };\r\n    });\r\n  };\r\n\r\n  const renderMessage = (message) => {\r\n    const isEditing = editingId === message.id;\r\n    const history = histories[message.id];\r\n    const hasHistory = !!history && history.versions.length >= 1;\r\n    const canPrev = hasHistory && history.currentIndex > 0;\r\n    const canNext = hasHistory && history.currentIndex < history.versions.length - 1;\r\n\r\n    return (\r\n      <div key={message.id} className={`message ${message.type}`}>\r\n        {isEditing ? (\r\n          <div className=\"edit-container\">\r\n            <textarea\r\n              value={editText}\r\n              onChange={(e) => setEditText(e.target.value)}\r\n              className=\"edit-textarea\"\r\n              autoFocus\r\n            />\r\n            <div className=\"edit-buttons\">\r\n              <button onClick={() => saveEdit(message.id)} disabled={loading || !editText.trim()} className=\"save-button\">\r\n                Save\r\n              </button>\r\n              <button onClick={cancelEdit} disabled={loading} className=\"cancel-button\">\r\n                Cancel\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"message-wrapper\">\r\n            <div className=\"message-content\">{message.content}</div>\r\n\r\n            {message.type === 'human' && (\r\n              <button onClick={() => startEdit(message)} className=\"edit-button\" disabled={loading}>\r\n                Edit\r\n              </button>\r\n            )}\r\n            {hasHistory && (\r\n              <div className=\"navigation-buttons\">\r\n                <button\r\n                  onClick={() => navigateVersion(message.id, -1)}\r\n                  className=\"nav-button\"\r\n                  disabled={loading || !canPrev}\r\n                  aria-label=\"Previous version\"\r\n                  title=\"Previous edited version\"\r\n                >\r\n                  &lt;\r\n                </button>\r\n                <span className=\"nav-indicator\">\r\n                  {history.currentIndex + 1}/{history.versions.length}\r\n                </span>\r\n                <button\r\n                  onClick={() => navigateVersion(message.id, 1)}\r\n                  className=\"nav-button\"\r\n                  disabled={loading || !canNext}\r\n                  aria-label=\"Next version\"\r\n                  title=\"Next edited version\"\r\n                >\r\n                  &gt;\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div>\r\n\r\n      <div className=\"dice_instruction\">\r\n        <p>\r\n          Please type \"number of dice + 'd' + number of sides on the dice\" to roll the dice\r\n        </p>\r\n        <p>\r\n          This app is aim to log and track your dice numbers and what happens when playing table games\r\n        </p>\r\n        <p>\r\n          Feel free to type some notes, it will keep your notes until you reload this web page\r\n        </p>\r\n        <p>\r\n          Example of use:\r\n        </p>\r\n        <p>\r\n          \"I got damaged from a ghoul, received damage 1 d 6\"\r\n        </p>\r\n        <p>\r\n          \"I obsered a murder, my sanity got hurt 1 d 4\"\r\n        </p>\r\n      </div>\r\n\r\n        <div className=\"chat-container\">\r\n          <div className=\"messages\">\r\n            {messages.map(renderMessage)}\r\n            {loading && (\r\n              <div className=\"message assistant\">\r\n                <div className=\"loading\">\r\n                  <span></span><span></span><span></span>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {error && <div className=\"error-message\">Error: {error}</div>}\r\n            <div ref={messagesEndRef} />\r\n          </div>\r\n          \r\n          <form onSubmit={handleSubmit} className=\"input-form\">\r\n            <input\r\n              ref={inputRef}\r\n              type=\"text\"\r\n              value={input}\r\n              onChange={(e) => setInput(e.target.value)}\r\n              placeholder=\"Type your message...\"\r\n              className=\"input-box\"\r\n              disabled={loading}\r\n            />\r\n            <button type=\"submit\" disabled={loading || !input.trim()}>\r\n              Send\r\n            </button>\r\n          </form>\r\n        </div>\r\n\r\n    </div>\r\n  );\r\n}\r\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","toPropertyKey","t","i","r","e","toPrimitive","call","TypeError","String","Number","_defineProperty","Object","defineProperty","value","enumerable","configurable","writable","ownKeys","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","push","apply","_objectSpread2","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","DICE_RE","trimMessage","message","results","m","exec","count","parseInt","sides","raw","trim","rollOnce","Math","floor","random","rollDice","rolls","Array","from","total","reduce","a","b","rollFromText","text","map","spec","_objectSpread","formatRollResults","lines","rollsStr","join","concat","grandTotal","s","DiceRolling","messages","setMessages","useState","input","setInput","loading","setLoading","error","setError","editingId","setEditingId","editText","setEditText","histories","setHistories","messagesEndRef","useRef","inputRef","uuid","_crypto","crypto","randomUUID","Date","now","toString","cloneMsgs","arr","msgsEqual","every","id","type","content","useEffect","prev","changed","next","mid","h","entries","idx","findIndex","newSuffix","slice","curVer","versions","currentIndex","suffix","newVersions","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","generateResponse","async","_lastHuman$content","lastHuman","_messageHistory","reverse","find","_inputRef$current","focus","cancelEdit","navigateVersion","messageId","dir","nextIndex","max","min","selected","curr","_jsxs","children","className","_jsx","isEditing","history","hasHistory","canPrev","canNext","onChange","target","autoFocus","onClick","messageIndex","original","prefix","originalSuffix","newContent","createdAt","newVersion","newMsgs","saveEdit","disabled","startEdit","title","ref","onSubmit","preventDefault","userMessage","newUserMessage","snapshot","placeholder"],"sourceRoot":""}