"use strict";(self.webpackChunkreact_dev=self.webpackChunkreact_dev||[]).push([[212],{212:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var r=n(43),o=n(579);const s=4,c=-1,a="react2048",l=80,i=10;function u(e){return Array.from({length:e},()=>Array(e).fill(0))}function d(e){const t=[];for(let n=0;n<e.length;n++)for(let r=0;r<e[n].length;r++)0===e[n][r]&&t.push([n,r]);return t}function f(e){const t=d(e);if(0===t.length)return e;const[n,r]=t[Math.floor(Math.random()*t.length)],o=e.map(e=>e.slice());return Math.random()<.3?o[n][r]=c:o[n][r]=Math.random()<.9?2:4,o}function m(){let e=u(s);return e=f(e),e=f(e),e}function h(e,t){const n=e===c;return e===t&&!n||n!==(t===c)}function w(e,t){const n=e===c;if(n&&t===c)return 0;return 2*(n?t:e)}function v(e){const t=e.length,n=u(t);for(let r=0;r<t;r++)for(let o=0;o<t;o++)n[t-1-o][r]=e[r][o];return n}function g(e){const t=e.length,n=u(t);for(let r=0;r<t;r++)for(let o=0;o<t;o++)n[o][t-1-r]=e[r][o];return n}function p(e){return e.map(e=>e.slice().reverse())}function x(e){const t=[];for(let l=0;l<e.length;l++)0!==e[l]&&t.push({v:e[l],fromC:l});const n=[],r=[],o=[];let s=0,c=0;for(let l=0;l<t.length;l++){const e=t[l],a=t[l+1];if(a&&h(e.v,a.v)){const t=w(e.v,a.v);n.push(t),r.push({fromC:e.fromC,toC:c,v:e.v,willMerge:!0}),r.push({fromC:a.fromC,toC:c,v:a.v,willMerge:!0}),o.push(c),s+=t,c++,l++}else n.push(e.v),r.push({fromC:e.fromC,toC:c,v:e.v,willMerge:!1}),c++}for(;n.length<e.length;)n.push(0);const a=r.some(e=>e.fromC!==e.toC);return{merged:n,moves:r,mergedDestCols:o,moved:a,gained:s}}function S(e,t){const n=e.length;let r=e.map(e=>e.slice());"up"===t?r=v(r):"down"===t?r=g(r):"right"===t&&(r=p(r));const o=[],s=[],c=[];let a=0,l=!1;for(let m=0;m<n;m++){const{merged:e,moves:t,mergedDestCols:n,moved:i,gained:u}=x(r[m]);o.push(e),s.push({r:m,moves:t}),n.forEach(e=>c.push({r:m,c:e})),i&&(l=!0),a+=u}let i="up"===t?g(o):"down"===t?v(o):"right"===t?p(o):o;function u(e,r){return"left"===t?{r:e,c:r}:"up"===t?{r:r,c:n-1-e}:"down"===t?{r:n-1-r,c:e}:{r:e,c:n-1-r}}const d=[];s.forEach(e=>{let{r:r,moves:o}=e;o.forEach(e=>{const o=function(e,r){return"left"===t?{r:e,c:r}:"up"===t?{r:r,c:n-1-e}:"down"===t?{r:n-1-r,c:e}:{r:e,c:n-1-r}}(r,e.fromC),s=u(r,e.toC);d.push({fromR:o.r,fromC:o.c,toR:s.r,toC:s.c,v:e.v,willMerge:e.willMerge})})});const f=c.map(e=>{let{r:t,c:n}=e;return u(t,n)});return{next:i,movedAny:l,gainedTotal:a,moves:d,mergedDest:f}}function j(e){if(e===c)return"cell2048 wild2048";if(!e)return"cell2048 v0";const t=[2,4,8,16,32,64,128,256,512,1024,2048,4096,8192];let n=Math.round(Math.log2(Math.abs(e)));(!Number.isFinite(n)||n<1)&&(n=1);return"cell2048 v".concat(t[(n-1)%t.length])}function C(e){if(e===c)return"??";if(!e)return"";if(e>8192){const t=String(e);if(t.length>2)return"".concat(t[0],"...").concat(t[t.length-1])}return String(e)}function b(e,t){return"".concat(e,"-").concat(t)}function N(e,t){return{x:t*(l+i),y:e*(l+i)}}function y(e){if(e<1e4)return null;const t=e-1e4,n=4.5*Math.pow(.85,Math.floor(t/2e3));return Math.max(.7,n)}function M(){const[e,t]=(0,r.useState)(()=>m()),[n,l]=(0,r.useState)(0),[i,u]=(0,r.useState)(!1),[h,w]=(0,r.useState)(null),[v,g]=(0,r.useState)(0),[p,x]=(0,r.useState)(!1),[M,k]=(0,r.useState)(!1),[D,B]=(0,r.useState)(!1),[A,E]=(0,r.useState)([]),[T,R]=(0,r.useState)(!1),[L,F]=(0,r.useState)(()=>new Set),[I,G]=(0,r.useState)(()=>new Set),[O,q]=(0,r.useState)(()=>new Set),[H,U]=(0,r.useState)(()=>{const e=localStorage.getItem(a),t=null==e?0:Number(e);return Number.isFinite(t)?t:0});function W(r){if(i||D)return;const{next:o,movedAny:s,gainedTotal:a,moves:m,mergedDest:h}=S(e,r);s&&(w(e.map(e=>e.slice())),g(n),x(i),k(!0),B(!0),E(m),F(new Set(m.map(e=>b(e.fromR,e.fromC)))),R(!1),requestAnimationFrame(()=>requestAnimationFrame(()=>R(!0))),window.setTimeout(()=>{const e=f(o),n=function(e,t){const n=[];for(let r=0;r<e.length;r++)for(let o=0;o<e[r].length;o++)0===e[r][o]&&0!==t[r][o]&&n.push("".concat(r,"-").concat(o));return n}(o,e);n.length&&(q(new Set(n)),window.setTimeout(()=>q(new Set),140)),t(e),l(e=>e+a),E([]),F(new Set),G(new Set(h.map(e=>b(e.r,e.c)))),function(e){if(d(e).length>0)return!1;const t=e.length;for(let n=0;n<t;n++)for(let r=0;r<t;r++){const o=e[n][r];if(r+1<t){const t=e[n][r+1];if(o===t&&o!==c||o===c!==(t===c))return!1}if(n+1<t){const t=e[n+1][r];if(o===t&&o!==c||o===c!==(t===c))return!1}}return!0}(e)&&u(!0),window.setTimeout(()=>G(new Set),140),B(!1)},65))}return(0,r.useEffect)(()=>{n>H&&(U(n),localStorage.setItem(a,String(n)))},[n,H]),(0,r.useEffect)(()=>{const e=e=>{const t={arrowup:"up",arrowdown:"down",arrowleft:"left",arrowright:"right",w:"up",s:"down",a:"left",d:"right"}[e.key.toLowerCase()];t&&(e.preventDefault(),W(t))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[e,i]),(0,o.jsxs)("div",{className:"container2048",children:[(0,o.jsxs)("div",{className:"instruction2048",children:[(0,o.jsx)("p",{children:"Control Keys:"}),(0,o.jsx)("p",{children:'Buttons below or "AWSD" on your keyboard'}),(0,o.jsx)("p",{children:"Note:"}),(0,o.jsx)("p",{children:"?? can merge with any numbers but itself"})]}),(0,o.jsxs)("div",{className:"header2048",children:[(0,o.jsx)("h2",{className:"title2048",children:"2048"}),(0,o.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(()=>{const e=y(n),t="score2048"+(e?" animateHue2048":""),r=e?{"--hueDur":"".concat(e,"s")}:void 0;return(0,o.jsxs)("span",{className:t,style:r,children:["Score: ",n]})})(),(()=>{const e=y(H),t="best2048"+(e?" animateHue2048":""),n=e?{"--hueDur":"".concat(e,"s")}:void 0;return(0,o.jsxs)("span",{className:t,style:n,children:["Best: ",H]})})(),(0,o.jsx)("button",{className:"btn2048",onClick:function(){const e=m();t(e),l(0),u(!1),E([]),F(new Set),G(new Set),q(new Set),R(!1),B(!1),w(null),g(0),x(!1),k(!1);const n=[];for(let t=0;t<s;t++)for(let r=0;r<s;r++)0!==e[t][r]&&n.push("".concat(t,"-").concat(r));q(new Set(n)),window.setTimeout(()=>q(new Set),140)},children:"New Game"})]})]}),i&&(0,o.jsx)("p",{className:"GameOver2048",children:" Game Over "}),(0,o.jsx)("div",{className:"undoButton2048wapper",children:(0,o.jsx)("button",{className:"btn2048 undoButton2048",onClick:function(){M&&!D&&h&&(t(h),l(v),u(p),E([]),F(new Set),G(new Set),q(new Set),R(!1),k(!1))},disabled:!M,children:"Undo"})}),(0,o.jsxs)("div",{className:"boardWrap2048",children:[(0,o.jsx)("div",{className:"grid2048",style:{"--cols":s},children:e.map((e,t)=>e.map((e,n)=>{const r=b(t,n),s=L.has(r),c=I.has(r),a=O.has(r),l=j(e)+(s?" movingOut2048":"")+(c?" flash2048":"")+(a?" spawn2048":"");return(0,o.jsx)("div",{className:l,children:C(e)},r)}))}),(0,o.jsx)("div",{className:"animLayer2048",children:A.map((e,t)=>{const n=N(e.fromR,e.fromC),r=N(e.toR,e.toC),s=r.x-n.x,c=r.y-n.y,a={left:n.x,top:n.y,transform:"translate3d(".concat(T?s:0,"px, ").concat(T?c:0,"px, 0)"),transitionDuration:"".concat(65,"ms")};return(0,o.jsx)("div",{className:"movingTile2048",children:(0,o.jsx)("div",{className:"movingInner2048 ".concat(j(e.v)),style:a,children:C(e.v)})},t)})})]}),(0,o.jsxs)("div",{className:"controls2048",role:"group","aria-label":"Move controls",children:[(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>W("up"),"aria-label":"Up",children:"\ud83d\udd3c"}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>W("left"),"aria-label":"Left",children:"\u25c0\ufe0f"}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>W("right"),"aria-label":"Right",children:"\u25b6\ufe0f"}),(0,o.jsx)("div",{}),(0,o.jsx)("button",{className:"btn2048 arrowBtn2048",onClick:()=>W("down"),"aria-label":"Down",children:"\ud83d\udd3d"}),(0,o.jsx)("div",{})]})]})}}}]);
//# sourceMappingURL=212.75fd8157.chunk.js.map